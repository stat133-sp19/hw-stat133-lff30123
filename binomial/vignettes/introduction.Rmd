---
title: "Getting Started with binomial"
author: "Fangfei Liu"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction to cointoss}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
```{r, echo = FALSE, message = FALSE}
knitr::opts_chunk$set(collapse = T, comment = "#>")
library(binomial)
```

## Binomial Distribution

The package `"binomial"` is created to calculate probabilities about the number of successes in a fixed number of random trials performed
under identical conditions (assuming a constant probability of success on each trial).


## R Functions

In order to create the package we created three type of functions:
private: these are auxiliary functions not intended to be called by the user (in red
color).

main: these are the main functions that the user is expected to invoke (in blue color).

methods: these are also public functions (in yellow color) that support classes of
objects generated by some of the main functions.

###Private Checker Functions
Those functions check whether inputs are valid. Examples are listed down below. The end users will not be able to invoke those. Those are only used to check whether the inputs are correct
1)Check Probability
It is a private auxiliary function to test if an input prob is a valid probability value (i.e. 0 < p < 1). check_prob() takes one input: prob. If prob is valid, then check_prob() should return TRUE. If prob is invalid, then check_prob() should stop() execution with an error—e.g. something like 'invalid prob value', or 'p has to be a number betwen 0 and 1'.
```{r eval=FALSE}
check_prob <- function(prob) {
  if (!is.numeric(prob)) {
    stop("\n'prob' must be a numeric value")
  }
  if (length(prob)!=1) {
    stop("\n'prob' must have length of 1")
  }
  if (any(prob < 0) | any(prob > 1)) {
    stop("\n'prob' values must be between 0 and 1")
  }
  TRUE
}
```
When we enter check_prob(0.8) into the function, it should return TRUE. When we enter check_prob(-1.1), it should return false because p can't be smaller than 0. Similiarly like this, there are two other checker functions that check for valid number of success and valid number of trials.


## Private Auxiliary Functions

All these functions take two arguments: trials and prob. And return the corresponding
value from the computed summary measure. Those functions are going to be called within the main functions. You can consider them as building blocks for the main functions:

```{r}
aux_mean <- function(trials,prob){
  result <- trials*prob
  return(result)
}
aux_mean(10, 0.3)


#Expected variance of number of success.
aux_variance <- function(trials,prob){
  result <- trials*prob*(1-prob)
  return(result)
}
aux_variance(10, 0.3)

#The most likely number of success in n independent trials with probability p
aux_mode <- function(trials,prob){
  m <- floor(trials*prob+prob)
  return(m)
}
aux_mode(10, 0.3)
#Skewness is a measure of the asymmetry of the probability distribution of a random variable about its mean.
aux_skewness <- function(trials,prob){
  skewness <- (1-2*prob)/sqrt(trials*prob*(1-prob))
  return(skewness)
}
aux_skewness(10, 0.3)
#kurtosis is a descriptor of the shape of a probability distribution
aux_kurtosis <- function(trials,prob){
  kurtosis <- (1-6*prob*(1-prob))/(trials*prob*(1-prob))
  return(kurtosis)
}
aux_kurtosis(10, 0.3)



```
## Main Functions

Now we are going to create main functions, those are the functions that are visible to the end users. Those functions are going to give us the probaility and the dataframes of probability distributions. 

###bin_probability
bin_probability should give us the an object of class "bindis and data.frame". Basically it gives us a dataframe with number of success and their corresponding probability. 
plot.bindis()shows a bar plot with number of successes on the x axis and probability on the y axis

```{r}
bin_distribution <- function(trials,prob){
  success <- c(0:trials)
  probability <- bin_probability(success,trials,prob)
  dat <- data.frame(success,probability)
  class(dat) <- c("bindis","data.frame")
  return(dat)
}
# binomial probability distribution
bin_distribution(trials = 5, prob = 0.5)

# plotting binomial probability distribution

plot.bindis <- function(datframe){barplot(datframe$probability,xlab="success",ylab="probability",names.arg = datframe$success,col="blue")}

# plotting binomial probability distribution
dis1 <- bin_distribution(trials = 5, prob = 0.5)
plot(dis1)
```

###bin_cumulative and plot.bincum
This function should return a data frame with both the probability distribution and thecumulative probabilities: sucesses in the first column, probability in the second column,and cumulative in the third column.

```{r}
bin_cumulative <- function(trials,prob){
  success <- 0:trials
  probability <- bin_probability(success,trials,prob)
  cumulative <- cumsum(probability)
  dat <- data.frame('success' = success, "probability"=probability,"cumulative"= cumulative)
  class(dat) <- c("bincum","data.frame")
  dat
}

bin_cumulative(trials = 5, prob = 0.5)
```

the plotting method will gives us a graph description the cumulative probability for getting certain number of successs. 

```{r}
plot.bincum <- function(datframe){
  result <- plot(datframe$success,datframe$cumulative,xlab="success",ylab="probability",type="o")
  return(result)
}
# plotting binomial cumulative distribution
dis2 <- bin_cumulative(trials = 5, prob = 0.5)
plot(dis2)
```
bin_variable function should creates an object of class "binvar". print.binvar(), summary.binvar(), and print.summary.binvar() should give us a printed out nice summary of our binomial random variable, including the following elements.
trials: number of trials
– prob: probability of success
– mean: mean or expected value
– variance: variance
– mode: mode
– skewness: skewness
– kurtosis: kurtosis
```{r}
# print method for object of class "toss"
print.binvar <- function(x) {
  cat(sprintf("Binomial variable"))
  cat(sprintf("\n"))
  cat(sprintf("\n"))
  cat("Parameters","\n")
  cat("- number of trials:", x$trials,"\n")
  cat("- prob of success:", x$prob, "\n")
  invisible(x)
}
print.binvar(bin_variable(trials = 10, prob = 0.3))

#Methods summary.binvar() and print.summary.binvar()

summary.binvar <- function(x) {
  summary <- list(
    trials = x$trials,
    prob = x$prob,
    mean = aux_mean(x$trials,x$prob),
    variance = aux_variance(x$trials,x$prob),
    mode = aux_mode(x$trials,x$prob),
    skewness = aux_skewness(x$trials,x$prob),
    kurtosis = aux_kurtosis(x$trials,x$prob))
  class(summary) <- "summary.binvar"
  return(summary)
}

bin1 <- bin_variable(trials = 10, prob = 0.3)
binsum1 <- summary(bin1)
binsum1


print.summary.binvar <- function(x) {
  cat(sprintf("Summary Binomial"))
  cat(sprintf("\n"))
  cat(sprintf("\n"))
  cat("Parameters","\n")
  cat("- number of trials:", x$trials,"\n")
  cat("- prob of success:", x$prob, "\n")
  cat(sprintf("\n"))
  cat(sprintf("\n"))
  cat("Measures","\n")
  cat("- mean    :", aux_mean(x[[1]],x[[2]]),"\n")
  cat("- variance:", aux_variance(x$trials,x$prob),"\n")
  cat("- mode    :", aux_mode(x$trials,x$prob), "\n")
  cat("- skewness:", aux_skewness(x$trials,x$prob), "\n")
  cat("- kurtosis:", aux_kurtosis(x$trials,x$prob), "\n")
  invisible(x)
}
```


For our packages, we also create a test package that will test whether our functions will give us correct output. Those tests should not be visible to the users. 
